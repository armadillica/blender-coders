<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>blendercoders.xyz</title>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment.js/2.11.0/moment.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/moment-timezone/0.5.0/moment-timezone-with-data-2010-2020.min.js"></script>
</head>
<body>
  <table>
    <thead>
      <tr>
        <th>Your Local time</th>
        <th>Reference Time</th>
      </tr>
    </thead>
    <tbody id="timetable">
    </tbody>
  </table>
  <script type="text/javascript">
    var xmlhttp = new XMLHttpRequest();
    var url = "{{url_for('meeting_times')}}";

    xmlhttp.onreadystatechange = function() {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
            var myArr = JSON.parse(xmlhttp.responseText);
            addScheduleRows(myArr.meeting_times);
        }
    };
    xmlhttp.open("GET", url, true);
    xmlhttp.send();

    function addScheduleRows(arr) {
        var out = "";
        var i;
        for(i = 0; i < arr.length; i++) {
            // Guess local timezone
            var local = moment.tz.guess();
            // Convert GMT timezone to local timezone
            var a = moment.tz(arr[i].gmt_time, local);
            // Add row to the timetable
            out += '<tr>' +
            '<td>' + a.format('ddd DD, hh:mm A') + '</td>' +
            '<td>' + '10:00 AM ' + arr[i].city + '</td>' +
            '</tr>';
        }
        document.getElementById("timetable").innerHTML = out;
    }
  </script>
</body>
</html>


